[
  {
    "name": "Todos",
    "type": "state",
    "ticks": [
      1,
      5,
      9,
      13,
      20,
      24
    ],
    "sourcedFrom": [
      {
        "name": "TodoAdded",
        "ticks": [
          4,
          8
        ]
      },
      {
        "name": "TodoDone",
        "ticks": [
          12,
          16
        ]
      },
      {
        "name": "AllTodosReset",
        "ticks": [
          19
        ]
      },
      {
        "name": "AllTodosFinished",
        "ticks": [
          23
        ]
      }
    ],
    "produces": [],
    "attachments": [],
    "scenarios": [
      {
        "name": "Timeline Scenario",
        "steps": [
          {
            "given": {
              "event": "TodoAdded",
              "data": {
                "todoId": "t-1",
                "title": "Buy milk"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": false
              }
            ]
          },
          {
            "given": {
              "event": "TodoAdded",
              "data": {
                "todoId": "t-2",
                "title": "Walk dog"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": false
              },
              {
                "id": "t-2",
                "title": "Walk dog",
                "done": false
              }
            ]
          },
          {
            "given": {
              "event": "TodoDone",
              "data": {
                "todoId": "t-1"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": true
              },
              {
                "id": "t-2",
                "title": "Walk dog",
                "done": false
              }
            ]
          },
          {
            "given": {
              "event": "TodoDone",
              "data": {
                "todoId": "t-2"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": false
              },
              {
                "id": "t-2",
                "title": "Walk dog",
                "done": false
              }
            ]
          },
          {
            "given": {
              "event": "AllTodosFinished",
              "data": {}
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": true
              },
              {
                "id": "t-2",
                "title": "Walk dog",
                "done": true
              }
            ]
          }
        ],
        "initialState": []
      },
      {
        "name": "Empty state with no events",
        "initialState": [],
        "steps": []
      },
      {
        "name": "Added items appear as open",
        "initialState": [],
        "steps": [
          {
            "given": {
              "event": "TodoAdded",
              "data": {
                "todoId": "t-1",
                "title": "Buy milk"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": false
              }
            ]
          }
        ]
      },
      {
        "name": "Done items are marked",
        "initialState": [],
        "steps": [
          {
            "given": {
              "event": "TodoAdded",
              "data": {
                "todoId": "t-1",
                "title": "Buy milk"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": false
              }
            ]
          },
          {
            "given": {
              "event": "TodoDone",
              "data": {
                "todoId": "t-1"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": true
              }
            ]
          }
        ]
      },
      {
        "name": "State evolution (step-by-step)",
        "initialState": [],
        "steps": [
          {
            "given": {
              "event": "TodoAdded",
              "data": {
                "todoId": "t-1",
                "title": "Buy milk"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": false
              }
            ]
          },
          {
            "given": {
              "event": "TodoAdded",
              "data": {
                "todoId": "t-2",
                "title": "Walk dog"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": false
              },
              {
                "id": "t-2",
                "title": "Walk dog",
                "done": false
              }
            ]
          },
          {
            "given": {
              "event": "TodoDone",
              "data": {
                "todoId": "t-1"
              }
            },
            "then": [
              {
                "id": "t-1",
                "title": "Buy milk",
                "done": true
              },
              {
                "id": "t-2",
                "title": "Walk dog",
                "done": false
              }
            ]
          }
        ]
      }
    ],
    "specScenarioCount": 4,
    "stateOccurrences": [
      {
        "tick": 1,
        "state": {
          "type": "state",
          "name": "Todos",
          "tick": 1,
          "sourcedFrom": [
            "TodoAdded",
            "TodoDone",
            "AllTodosReset",
            "AllTodosFinished"
          ],
          "example": []
        }
      },
      {
        "tick": 5,
        "state": {
          "type": "state",
          "name": "Todos",
          "tick": 5,
          "sourcedFrom": [
            "TodoAdded",
            "TodoDone",
            "AllTodosReset",
            "AllTodosFinished"
          ],
          "example": [
            {
              "id": "t-1",
              "title": "Buy milk",
              "done": false
            }
          ]
        }
      },
      {
        "tick": 9,
        "state": {
          "type": "state",
          "name": "Todos",
          "tick": 9,
          "sourcedFrom": [
            "TodoAdded",
            "TodoDone",
            "AllTodosReset",
            "AllTodosFinished"
          ],
          "example": [
            {
              "id": "t-1",
              "title": "Buy milk",
              "done": false
            },
            {
              "id": "t-2",
              "title": "Walk dog",
              "done": false
            }
          ]
        }
      },
      {
        "tick": 13,
        "state": {
          "type": "state",
          "name": "Todos",
          "tick": 13,
          "sourcedFrom": [
            "TodoAdded",
            "TodoDone",
            "AllTodosReset",
            "AllTodosFinished"
          ],
          "example": [
            {
              "id": "t-1",
              "title": "Buy milk",
              "done": true
            },
            {
              "id": "t-2",
              "title": "Walk dog",
              "done": false
            }
          ]
        }
      },
      {
        "tick": 20,
        "state": {
          "type": "state",
          "name": "Todos",
          "tick": 20,
          "sourcedFrom": [
            "TodoAdded",
            "TodoDone",
            "AllTodosReset",
            "AllTodosFinished"
          ],
          "example": [
            {
              "id": "t-1",
              "title": "Buy milk",
              "done": false
            },
            {
              "id": "t-2",
              "title": "Walk dog",
              "done": false
            }
          ]
        }
      },
      {
        "tick": 24,
        "state": {
          "type": "state",
          "name": "Todos",
          "tick": 24,
          "sourcedFrom": [
            "TodoAdded",
            "TodoDone",
            "AllTodosReset",
            "AllTodosFinished"
          ],
          "example": [
            {
              "id": "t-1",
              "title": "Buy milk",
              "done": true
            },
            {
              "id": "t-2",
              "title": "Walk dog",
              "done": true
            }
          ]
        }
      }
    ],
    "commandOccurrences": [],
    "example": []
  },
  {
    "name": "AddTodo",
    "type": "command",
    "ticks": [
      3,
      7
    ],
    "sourcedFrom": [],
    "produces": [
      {
        "name": "TodoAdded",
        "ticks": [
          4,
          8
        ]
      }
    ],
    "attachments": [],
    "scenarios": [
      {
        "name": "Timeline Scenario",
        "rows": [
          {
            "type": "command",
            "command": {
              "name": "AddTodo",
              "data": {
                "title": "Buy milk"
              }
            },
            "producedEvents": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              }
            ]
          },
          {
            "type": "command",
            "command": {
              "name": "AddTodo",
              "data": {
                "title": "Walk dog"
              }
            },
            "producedEvents": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-2",
                  "title": "Walk dog"
                }
              }
            ]
          }
        ]
      },
      {
        "name": "Successfully add a valid todo",
        "steps": [
          {
            "type": "command",
            "when": {
              "title": "Buy milk"
            },
            "produces": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              }
            ]
          }
        ]
      },
      {
        "name": "Reject empty title",
        "steps": [
          {
            "type": "command",
            "when": {
              "title": ""
            },
            "fails": "Title must not be empty"
          }
        ]
      },
      {
        "name": "Reject when max items reached",
        "steps": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Item 1"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-2",
                  "title": "Item 2"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-3",
                  "title": "Item 3"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-4",
                  "title": "Item 4"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-5",
                  "title": "Item 5"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-6",
                  "title": "Item 6"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-7",
                  "title": "Item 7"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-8",
                  "title": "Item 8"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-9",
                  "title": "Item 9"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-10",
                  "title": "Item 10"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {
              "title": "Item 11"
            },
            "fails": "Cannot have more than 10 todos"
          }
        ]
      }
    ],
    "specScenarioCount": 3,
    "stateOccurrences": [],
    "commandOccurrences": [
      {
        "tick": 3,
        "command": {
          "type": "command",
          "name": "AddTodo",
          "tick": 3,
          "example": {
            "title": "Buy milk"
          }
        },
        "producedEvents": [
          {
            "type": "event",
            "name": "TodoAdded",
            "tick": 4,
            "producedBy": "AddTodo-3",
            "example": {
              "todoId": "t-1",
              "title": "Buy milk"
            }
          }
        ]
      },
      {
        "tick": 7,
        "command": {
          "type": "command",
          "name": "AddTodo",
          "tick": 7,
          "example": {
            "title": "Walk dog"
          }
        },
        "producedEvents": [
          {
            "type": "event",
            "name": "TodoAdded",
            "tick": 8,
            "producedBy": "AddTodo-7",
            "example": {
              "todoId": "t-2",
              "title": "Walk dog"
            }
          }
        ]
      }
    ],
    "example": {
      "title": "Buy milk"
    }
  },
  {
    "name": "FinishTodo",
    "type": "command",
    "ticks": [
      11,
      15
    ],
    "sourcedFrom": [],
    "produces": [
      {
        "name": "TodoDone",
        "ticks": [
          12,
          16
        ]
      }
    ],
    "attachments": [],
    "scenarios": [
      {
        "name": "Timeline Scenario",
        "rows": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-2",
                  "title": "Walk dog"
                }
              }
            ]
          },
          {
            "type": "command",
            "command": {
              "name": "FinishTodo",
              "data": {
                "todoId": "t-1"
              }
            },
            "producedEvents": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-1"
                }
              }
            ]
          },
          {
            "type": "command",
            "command": {
              "name": "FinishTodo",
              "data": {
                "todoId": "t-2"
              }
            },
            "producedEvents": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-2"
                }
              }
            ]
          }
        ]
      },
      {
        "name": "Successfully mark multiple todos as done",
        "steps": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {
              "todoId": "t-1"
            },
            "produces": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-1"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {
              "todoId": "t-1"
            },
            "fails": "Todo is already done"
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-2",
                  "title": "Walk dog"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-3",
                  "title": "Call mom"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {
              "todoId": "t-2"
            },
            "produces": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-2"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "AllTodosReset",
                "data": {}
              }
            ]
          },
          {
            "type": "command",
            "when": {
              "todoId": "t-3"
            },
            "produces": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-3"
                }
              }
            ]
          }
        ]
      },
      {
        "name": "Reject when todo not found",
        "steps": [
          {
            "type": "command",
            "when": {
              "todoId": "non-existent"
            },
            "fails": "Todo not found"
          }
        ]
      },
      {
        "name": "Reject when already done",
        "steps": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              },
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-1"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {
              "todoId": "t-1"
            },
            "fails": "Todo is already done"
          }
        ]
      }
    ],
    "specScenarioCount": 3,
    "stateOccurrences": [],
    "commandOccurrences": [
      {
        "tick": 11,
        "command": {
          "type": "command",
          "name": "FinishTodo",
          "tick": 11,
          "example": {
            "todoId": "t-1"
          }
        },
        "producedEvents": [
          {
            "type": "event",
            "name": "TodoDone",
            "tick": 12,
            "producedBy": "FinishTodo-11",
            "example": {
              "todoId": "t-1"
            }
          }
        ]
      },
      {
        "tick": 15,
        "command": {
          "type": "command",
          "name": "FinishTodo",
          "tick": 15,
          "example": {
            "todoId": "t-2"
          }
        },
        "producedEvents": [
          {
            "type": "event",
            "name": "TodoDone",
            "tick": 16,
            "producedBy": "FinishTodo-15",
            "example": {
              "todoId": "t-2"
            }
          }
        ]
      }
    ],
    "example": {
      "todoId": "t-1"
    }
  },
  {
    "name": "ResetAllTodos",
    "type": "command",
    "ticks": [
      18
    ],
    "sourcedFrom": [],
    "produces": [
      {
        "name": "AllTodosReset",
        "ticks": [
          19
        ]
      }
    ],
    "attachments": [],
    "scenarios": [
      {
        "name": "Timeline Scenario",
        "rows": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-2",
                  "title": "Walk dog"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-1"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "NotificationSent",
                "data": {
                  "type": "todo_completed",
                  "todoId": "t-1",
                  "channel": "push"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-2"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "ReminderTriggered",
                "data": {
                  "todoId": "t-2",
                  "message": "Don't forget to walk the dog!"
                }
              }
            ]
          },
          {
            "type": "command",
            "command": {
              "name": "ResetAllTodos",
              "data": {}
            },
            "producedEvents": [
              {
                "event": "AllTodosReset",
                "data": {}
              }
            ]
          }
        ]
      },
      {
        "name": "Successfully reset all todos",
        "steps": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              },
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-1"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {},
            "produces": [
              {
                "event": "AllTodosReset",
                "data": {}
              }
            ]
          }
        ]
      },
      {
        "name": "Reject when no todos exist",
        "steps": [
          {
            "type": "command",
            "when": {},
            "fails": "No todos to reset"
          }
        ]
      }
    ],
    "specScenarioCount": 2,
    "stateOccurrences": [],
    "commandOccurrences": [
      {
        "tick": 18,
        "command": {
          "type": "command",
          "name": "ResetAllTodos",
          "tick": 18,
          "example": {}
        },
        "producedEvents": [
          {
            "type": "event",
            "name": "AllTodosReset",
            "tick": 19,
            "producedBy": "ResetAllTodos-18",
            "example": {}
          }
        ]
      }
    ],
    "example": {}
  },
  {
    "name": "FinishAllTodos",
    "type": "command",
    "ticks": [
      22
    ],
    "sourcedFrom": [],
    "produces": [
      {
        "name": "AllTodosFinished",
        "ticks": [
          23
        ]
      }
    ],
    "attachments": [],
    "scenarios": [
      {
        "name": "Timeline Scenario",
        "rows": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-2",
                  "title": "Walk dog"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-1"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "NotificationSent",
                "data": {
                  "type": "todo_completed",
                  "todoId": "t-1",
                  "channel": "push"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-2"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "ReminderTriggered",
                "data": {
                  "todoId": "t-2",
                  "message": "Don't forget to walk the dog!"
                }
              }
            ]
          },
          {
            "type": "events-only",
            "events": [
              {
                "event": "AllTodosReset",
                "data": {}
              }
            ]
          },
          {
            "type": "command",
            "command": {
              "name": "FinishAllTodos",
              "data": {}
            },
            "producedEvents": [
              {
                "event": "AllTodosFinished",
                "data": {}
              }
            ]
          }
        ]
      },
      {
        "name": "Successfully finish all todos",
        "steps": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              },
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-2",
                  "title": "Walk dog"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {},
            "produces": [
              {
                "event": "AllTodosFinished",
                "data": {}
              }
            ]
          }
        ]
      },
      {
        "name": "Reject when no open todos",
        "steps": [
          {
            "type": "events-only",
            "events": [
              {
                "event": "TodoAdded",
                "data": {
                  "todoId": "t-1",
                  "title": "Buy milk"
                }
              },
              {
                "event": "TodoDone",
                "data": {
                  "todoId": "t-1"
                }
              }
            ]
          },
          {
            "type": "command",
            "when": {},
            "fails": "No open todos to finish"
          }
        ]
      }
    ],
    "specScenarioCount": 2,
    "stateOccurrences": [],
    "commandOccurrences": [
      {
        "tick": 22,
        "command": {
          "type": "command",
          "name": "FinishAllTodos",
          "tick": 22,
          "example": {}
        },
        "producedEvents": [
          {
            "type": "event",
            "name": "AllTodosFinished",
            "tick": 23,
            "producedBy": "FinishAllTodos-22",
            "example": {}
          }
        ]
      }
    ],
    "example": {}
  }
]